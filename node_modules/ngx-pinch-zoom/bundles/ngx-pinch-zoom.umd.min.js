!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-pinch-zoom",["exports","@angular/core","@angular/common"],e):e(t["ngx-pinch-zoom"]={},t.ng.core,t.ng.common)}(this,function(t,e,i){"use strict";var s=function(){function t(t){this.elementRef=t,this.i=0,this.scale=1,this.initialScale=1,this.moveX=0,this.moveY=0,this.initialMoveX=0,this.initialMoveY=0,this.lastTap=0,this.draggingMode=!1,this.transitionDuration=200,this.doubleTap=!0,this.doubleTapScale=2,this.zoomButton=!0,this.linearHorizontalSwipe=!1,this.linearVerticalSwipe=!1,this.autoZoomOut=!1,this.disabled=!1,this.events=new e.EventEmitter}return t.prototype.ngOnInit=function(){this.element=this.contentElement.nativeElement,this.parentElement=this.elementRef.nativeElement,this.elementTarget=this.element.querySelector("*").tagName,this.setBasicStyles(),this.element.ondragstart=function(){return!1}},Object.defineProperty(t.prototype,"isTouchScreen",{get:function(){var t=" -webkit- -moz- -o- -ms- ".split(" ");if("ontouchstart"in window)return!0;var e,i=["(",t.join("touch-enabled),("),"heartz",")"].join("");return e=i,window.matchMedia(e).matches},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDragging",{get:function(){var t=this.getImageHeight(),e=this.getImageWidth();return 1<this.scale?t*this.scale>this.parentElement.offsetHeight||e*this.scale>this.parentElement.offsetWidth:1===this.scale?t>this.parentElement.offsetHeight||e>this.parentElement.offsetWidth:void 0},enumerable:!0,configurable:!0}),t.prototype.onMouseEnter=function(t){this.getElementPosition(),this.isDragging&&(this.draggingMode=!0)},t.prototype.onMouseMove=function(t){this.draggingMode&&(t.preventDefault(),this.eventType||(this.startX=t.clientX-this.elementPosition.left,this.startY=t.clientY-this.elementPosition.top),this.eventType="swipe",this.events.emit({type:"swipe",moveX:this.moveX,moveY:this.moveY}),this.moveX=this.initialMoveX+(t.clientX-this.elementPosition.left-this.startX),this.moveY=this.initialMoveY+(t.clientY-this.elementPosition.top-this.startY),this.centeringImage(),this.transformElement(0))},t.prototype.onMouseUp=function(t){this.draggingMode=!1,this.updateInitialValues(),this.eventType=undefined},t.prototype.onResize=function(t){this.setImageWidth(),this.transformElement(this.transitionDuration)},t.prototype.touchstartHandler=function(t){this.disabled||(this.getElementPosition(),this.eventType===undefined&&this.getStartPosition(t),this.events.emit({type:"touchstart"}))},t.prototype.touchmoveHandler=function(t){if(!this.disabled){var e=t.touches;(this.detectSwipe(e)||"swipe"===this.eventType)&&this.handleSwipe(t),(this.detectLinearSwipe(e)||"horizontal-swipe"===this.eventType||"vertical-swipe"===this.eventType)&&this.handleLinearSwipe(t),(2===e.length&&this.eventType===undefined||"pinch"===this.eventType)&&this.handlePinch(t)}},t.prototype.touchendHandler=function(t){if(!this.disabled){this.i=0,this.draggingMode=!1;var e=t.touches;if(this.scale<1&&(this.scale=1),this.autoZoomOut&&"pinch"===this.eventType&&(this.scale=1),this.events.emit({type:"touchend"}),this.doubleTapDetection()&&this.eventType===undefined)return this.toggleZoom(t),void this.events.emit({type:"double-tap"});this.limitZoom&&"pinch"===this.eventType&&this.handleLimitZoom(),"pinch"!==this.eventType&&"swipe"!==this.eventType||this.alignImage(),"pinch"!==this.eventType&&"swipe"!==this.eventType&&"horizontal-swipe"!==this.eventType&&"vertical-swipe"!==this.eventType||this.updateInitialValues(),this.eventType="touchend",e&&0===e.length&&(this.eventType=undefined)}},t.prototype.moveLeft=function(t,e){return e[t].clientX-this.elementPosition.left},t.prototype.moveTop=function(t,e){return e[t].clientY-this.elementPosition.top},t.prototype.handleSwipe=function(t){t.preventDefault(),this.eventType||(this.startX=t.touches[0].clientX-this.elementPosition.left,this.startY=t.touches[0].clientY-this.elementPosition.top),this.eventType="swipe",this.events.emit({type:"swipe",moveX:this.moveX,moveY:this.moveY}),this.moveX=this.initialMoveX+(this.moveLeft(0,t.touches)-this.startX),this.moveY=this.initialMoveY+(this.moveTop(0,t.touches)-this.startY),this.transformElement(0)},t.prototype.handlePinch=function(t){t.preventDefault();var e=t.touches;if(!this.eventType){this.initialDistance=this.getDistance(e);var i=this.moveLeft(0,e),s=this.moveLeft(1,e),n=this.moveTop(0,e),o=this.moveTop(1,e);this.moveXC=(i+s)/2-this.initialMoveX,this.moveYC=(n+o)/2-this.initialMoveY}this.eventType="pinch",this.distance=this.getDistance(e),this.scale=this.initialScale*(this.distance/this.initialDistance),this.events.emit({type:"pinch",scale:this.scale}),this.moveX=this.initialMoveX-(this.distance/this.initialDistance*this.moveXC-this.moveXC),this.moveY=this.initialMoveY-(this.distance/this.initialDistance*this.moveYC-this.moveYC),this.transformElement(0)},t.prototype.handleLinearSwipe=function(t){this.linearVerticalSwipe&&t.preventDefault(),this.i++,3<this.i&&(this.eventType=this.getLinearSwipeType(t)),"horizontal-swipe"===this.eventType&&(this.moveX=this.initialMoveX+(t.touches[0].clientX-this.elementPosition.left-this.startX),this.moveY=0),"vertical-swipe"===this.eventType&&(this.moveX=0,this.moveY=this.initialMoveY+(t.touches[0].clientY-this.elementPosition.top-this.startY)),this.eventType&&(this.events.emit({type:this.eventType,moveX:this.moveX,moveY:this.moveY}),this.transformElement(0))},t.prototype.handleLimitZoom=function(){if(this.scale>this.limitZoom){var t=this.getImageWidth(),e=this.getImageHeight(),i=t*this.scale,s=e*this.scale,n=this.moveX/(i-t),o=this.moveY/(s-e);this.scale=this.limitZoom;var h=t*this.scale,a=e*this.scale;this.moveX=-Math.abs(n*(h-t)),this.moveY=-Math.abs(-o*(a-e)),this.centeringImage(),this.transformElement(this.transitionDuration)}},t.prototype.detectSwipe=function(t){return 1===t.length&&1<this.scale&&!this.eventType},t.prototype.detectLinearSwipe=function(t){return 1===t.length&&1===this.scale&&!this.eventType},t.prototype.getLinearSwipeType=function(t){return"horizontal-swipe"===this.eventType||"vertical-swipe"===this.eventType?this.eventType:Math.abs(this.moveLeft(0,t.touches)-this.startX)<3*Math.abs(this.moveTop(0,t.touches)-this.startY)?this.linearVerticalSwipe?"vertical-swipe":undefined:this.linearHorizontalSwipe?"horizontal-swipe":undefined},t.prototype.getDistance=function(t){return Math.sqrt(Math.pow(t[0].pageX-t[1].pageX,2)+Math.pow(t[0].pageY-t[1].pageY,2))},t.prototype.getImageHeight=function(){return this.element.getElementsByTagName(this.elementTarget)[0].offsetHeight},t.prototype.getImageWidth=function(){return this.element.getElementsByTagName(this.elementTarget)[0].offsetWidth},t.prototype.getStartPosition=function(t){this.startX=t.touches[0].clientX-this.elementPosition.left,this.startY=t.touches[0].clientY-this.elementPosition.top},t.prototype.setBasicStyles=function(){this.element.style.display="flex",this.element.style.height="100%",this.element.style.alignItems="center",this.element.style.justifyContent="center",this.element.style.transformOrigin="0 0",this.hostDisplay="block",this.hostOverflow="hidden",this.hostHeight=this.containerHeight,this.setImageWidth()},t.prototype.setImageWidth=function(){var t=this.element.getElementsByTagName(this.elementTarget);t.length&&(t[0].style.maxWidth="100%",t[0].style.maxHeight="100%")},t.prototype.transformElement=function(t){void 0===t&&(t=50),this.element.style.transition="all "+t+"ms",this.element.style.transform="\n            matrix("+Number(this.scale)+", 0, 0, "+Number(this.scale)+", "+Number(this.moveX)+", "+Number(this.moveY)+")"},t.prototype.doubleTapDetection=function(){var t=this;if(!this.doubleTap)return!1;var e=(new Date).getTime(),i=e-this.lastTap;if(clearTimeout(this.doubleTapTimeout),i<300&&0<i)return!0;this.doubleTapTimeout=setTimeout(function(){clearTimeout(t.doubleTapTimeout)},300),this.lastTap=e},t.prototype.toggleZoom=function(t){if(void 0===t&&(t=!1),1===this.initialScale){if(t&&t.changedTouches){var e=t.changedTouches;this.scale=this.initialScale*this.doubleTapScale,this.moveX=this.initialMoveX-(e[0].clientX*(this.doubleTapScale-1)-this.elementPosition.left),this.moveY=this.initialMoveY-(e[0].clientY*(this.doubleTapScale-1)-this.elementPosition.top)}else this.scale=2*this.initialScale,this.moveX=this.initialMoveX-this.element.offsetWidth/2,this.moveY=this.initialMoveY-this.element.offsetHeight/2;this.centeringImage(),this.updateInitialValues(),this.transformElement(this.transitionDuration),this.events.emit({type:"zoom-in"})}else this.resetScale(),this.events.emit({type:"zoom-out"})},t.prototype.resetScale=function(){this.scale=1,this.moveX=0,this.moveY=0,this.updateInitialValues(),this.transformElement(this.transitionDuration)},t.prototype.updateInitialValues=function(){this.initialScale=this.scale,this.initialMoveX=this.moveX,this.initialMoveY=this.moveY},t.prototype.centeringImage=function(){var t=this.element.getElementsByTagName(this.elementTarget)[0],e=this.moveX,i=this.moveY;return 0<this.moveY&&(this.moveY=0),0<this.moveX&&(this.moveX=0),t&&(this.transitionYRestriction(),this.transitionXRestriction()),t&&this.scale<1&&this.moveX<this.element.offsetWidth*(1-this.scale)&&(this.moveX=this.element.offsetWidth*(1-this.scale)),e!==this.moveX||i!==this.moveY},t.prototype.alignImage=function(){this.centeringImage()&&(this.updateInitialValues(),this.transformElement(this.transitionDuration))},t.prototype.transitionYRestriction=function(){var t=this.getImageHeight();if(t*this.scale<this.parentElement.offsetHeight)this.moveY=(this.parentElement.offsetHeight-this.element.offsetHeight*this.scale)/2;else{var e=(t-this.element.offsetHeight)*this.scale/2;this.moveY>e?this.moveY=e:t*this.scale+Math.abs(e)-this.parentElement.offsetHeight+this.moveY<0&&(this.moveY=-(t*this.scale+Math.abs(e)-this.parentElement.offsetHeight))}},t.prototype.transitionXRestriction=function(){var t=this.getImageWidth();if(t*this.scale<this.parentElement.offsetWidth)this.moveX=(this.parentElement.offsetWidth-this.element.offsetWidth*this.scale)/2;else{var e=(t-this.element.offsetWidth)*this.scale/2;this.moveX>e?this.moveX=e:t*this.scale+Math.abs(e)-this.parentElement.offsetWidth+this.moveX<0&&(this.moveX=-(t*this.scale+Math.abs(e)-this.parentElement.offsetWidth))}},t.prototype.getElementPosition=function(){this.elementPosition=this.elementRef.nativeElement.getBoundingClientRect()},t.prototype.setMoveX=function(t,e){void 0===e&&(e=200),this.moveX=t,this.transformElement(e)},t.prototype.setMoveY=function(t,e){void 0===e&&(e=200),this.moveY=t,this.transformElement(e)},t.decorators=[{type:e.Component,args:[{selector:"pinch-zoom, [pinch-zoom]",template:'<div #content \n\t[class.pz-dragging]="isDragging">\n\t<ng-content></ng-content>\n</div>\n\n<div class="pz-zoom-button"\n\t*ngIf="zoomButton && !isTouchScreen && !disabled"\n\t(click)="toggleZoom()"\n\t[class.pz-zoom-out]="scale > 1">\n</div>',styles:[":host{position:relative}.pz-dragging{cursor:all-scroll}.pz-zoom-button{position:absolute;left:50%;bottom:16px;margin-left:-22px;z-index:1000;color:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABVUlEQVR4Ae3PAwxQXRgA0Pvbto1sW2NDts0x27atIdeQrakpY8i23cnGe5nn8epDeO1h+VgeVdRVRJLwsCQ101nX2aWJd8OD8a7Ozrkda6UJ8XnPUsBZy43S2Wz7rs8UDnEZCZjn5+tzb6jqCDgucYhDakAnb4Rb+MdmMCPEYSqYfH2cXfPr/ymcBalDFF84izN+uD7TnHCdXqB7iCI/WByuuy1QbrAiRFEL9L3WlObmc/l7uUHfgn0hivqg47VaXMfluQ/A6RBFeTDmnq39D7aEKNKBXfcMVBVMCtFsB0XvFshbVoBSIZqGYL8/wh10B/u8F6L52E6wU7ZwEx/oC6gV4pHVOXDeIPn95WOZ1bYRsD7EJ79D7m4nmO7dEI+fTHC7o7p6h+uh4pJJB0vscMwKQ+X13uXZ6RGh4vKeeQ8c6nWoJiFadCjRFUXzntbeDc/GaxcAotf7cicflKkAAAAASUVORK5CYII=),url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABS0lEQVR4Ae3UA8xWfQCG8afPNrNt240N2TbHbNu2hlxDtqamjCHbdr/s5905b9Z1fN/bdfyPfOZl8ZMSGmipggwvL8loqZsAOKaDb2Ir+UZ/t7zITjlio/nWRsBNm03T33KnHiflw4umAlaJ/ziLo6EL4LL04TTZAf3Eea5JYT9YEk60EMyP2mVxE2QP1vzuJm74P4Z+GBgcLCoN1sfYFwdbgkXNwMj7+4V1fnq6n/0DTgWLWoO+9/c7AwD3s+/B9WBRbTAjxj41OBAsygWOxdg3BPMiwTgMKkbtvrQFVAsjagtOSxKlGwxO+Tbc0HEUHFXomfx7IwHNIuFQ0C1w2zilJfOT/JrbC9gdCY/SzonOUbA49Mgknjme56KBvuaxKizy6WODIy7ZYqKSDx6xxUGq8MPeqlirPqs6RKljqwq6ovCq7r6JvBs+cwdLiOaEU9ek1AAAAABJRU5ErkJggg==),url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABVUlEQVR4Ae3PAwxQXRgA0Pvbto1sW2NDts0x27atIdeQrakpY8i23cnGe5nn8epDeO1h+VgeVdRVRJLwsCQ101nX2aWJd8OD8a7Ozrkda6UJ8XnPUsBZy43S2Wz7rs8UDnEZCZjn5+tzb6jqCDgucYhDakAnb4Rb+MdmMCPEYSqYfH2cXfPr/ymcBalDFF84izN+uD7TnHCdXqB7iCI/WByuuy1QbrAiRFEL9L3WlObmc/l7uUHfgn0hivqg47VaXMfluQ/A6RBFeTDmnq39D7aEKNKBXfcMVBVMCtFsB0XvFshbVoBSIZqGYL8/wh10B/u8F6L52E6wU7ZwEx/oC6gV4pHVOXDeIPn95WOZ1bYRsD7EJ79D7m4nmO7dEI+fTHC7o7p6h+uh4pJJB0vscMwKQ+X13uXZ6RGh4vKeeQ8c6nWoJiFadCjRFUXzntbeDc/GaxcAotf7cicflKkAAAAASUVORK5CYII=),url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABS0lEQVR4Ae3UA8xWfQCG8afPNrNt240N2TbHbNu2hlxDtqamjCHbdr/s5905b9Z1fN/bdfyPfOZl8ZMSGmipggwvL8loqZsAOKaDb2Ir+UZ/t7zITjlio/nWRsBNm03T33KnHiflw4umAlaJ/ziLo6EL4LL04TTZAf3Eea5JYT9YEk60EMyP2mVxE2QP1vzuJm74P4Z+GBgcLCoN1sfYFwdbgkXNwMj7+4V1fnq6n/0DTgWLWoO+9/c7AwD3s+/B9WBRbTAjxj41OBAsygWOxdg3BPMiwTgMKkbtvrQFVAsjagtOSxKlGwxO+Tbc0HEUHFXomfx7IwHNIuFQ0C1w2zilJfOT/JrbC9gdCY/SzonOUbA49Mgknjme56KBvuaxKizy6WODIy7ZYqKSDx6xxUGq8MPeqlirPqs6RKljqwq6ovCq7r6JvBs+cwdLiOaEU9ek1AAAAABJRU5ErkJggg==);background-color:rgba(0,0,0,.8);background-position:center,-1000px;background-repeat:no-repeat,no-repeat;width:56px;height:56px;border-radius:4px;opacity:.5;cursor:pointer;transition:opacity .1s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.pz-zoom-button.pz-zoom-out{background-position:-1000px,center}.pz-zoom-button:hover{opacity:.7}"]}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={containerHeight:[{type:e.Input,args:["height"]}],transitionDuration:[{type:e.Input,args:["transition-duration"]}],doubleTap:[{type:e.Input,args:["double-tap"]}],doubleTapScale:[{type:e.Input,args:["double-tap-scale"]}],zoomButton:[{type:e.Input,args:["zoom-button"]}],linearHorizontalSwipe:[{type:e.Input,args:["linear-horizontal-swipe"]}],linearVerticalSwipe:[{type:e.Input,args:["linear-vertical-swipe"]}],autoZoomOut:[{type:e.Input,args:["auto-zoom-out"]}],limitZoom:[{type:e.Input,args:["limit-zoom"]}],disabled:[{type:e.Input,args:["disabled"]}],events:[{type:e.Output}],hostDisplay:[{type:e.HostBinding,args:["style.display"]}],hostOverflow:[{type:e.HostBinding,args:["style.overflow"]}],hostHeight:[{type:e.HostBinding,args:["style.height"]}],contentElement:[{type:e.ViewChild,args:["content"]}],onMouseEnter:[{type:e.HostListener,args:["mousedown",["$event"]]}],onMouseMove:[{type:e.HostListener,args:["window:mousemove",["$event"]]}],onMouseUp:[{type:e.HostListener,args:["window:mouseup",["$event"]]}],onResize:[{type:e.HostListener,args:["window:resize",["$event"]]}],touchstartHandler:[{type:e.HostListener,args:["touchstart",["$event"]]}],touchmoveHandler:[{type:e.HostListener,args:["touchmove",["$event"]]}],touchendHandler:[{type:e.HostListener,args:["touchend",["$event"]]}]},t}(),n=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[s],imports:[i.CommonModule],exports:[s],entryComponents:[s]}]}],t}();t.PinchZoomComponent=s,t.PinchZoomModule=n,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-pinch-zoom.umd.min.js.map